<!DOCTYPE html>
<html>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KZEXBPVEMZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KZEXBPVEMZ');
</script>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://aplikasihebat.com/blog/" accesskey="h" title="Blog Aplikasi Hebat (Alt + H)">Blog Aplikasi Hebat</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://aplikasihebat.com/blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://aplikasihebat.com/blog/posts" title="All posts">
                    <span>All posts</span>
                </a>
            </li>
            <li>
                <a href="https://aplikasihebat.com/blog/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://aplikasihebat.com/blog/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://aplikasihebat.com/">Blog Aplikasi Hebat</a>
	</div>
	<nav>
		
		<a href="/blog/">Home</a>
		
		<a href="/blog/posts">All posts</a>
		
		<a href="/blog/about">About</a>
		
		<a href="/blog/tags">Tags</a>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Bugs in Audioplayers Package</h1>
			<div class="meta">Posted on Sep 30, 2024</div>
		</div>
		

		

		<section class="body">
			<p>This writings is to remind myself in the future when developing apps using flutter and especially if using
<a href="https://pub.dev/packages/audioplayers">AudioPlayers</a> package.</p>
<h1 id="the-bug">The Bug</h1>
<p>So for my <a href="https://play.google.com/store/apps/details?id=com.aplikasihebat.baca_app">application</a> which is an education App i have been developed for over one year now, started as unserious project because i had google developer account that has been laying around. It was when Flutter was began to get famous for it&rsquo;s flexibility, write once and publish everywhere, either google play store, ios, web, and desktop. Intrigued by the promise, i dipped my hand in this framework. Honestly i quite like the way flutter create the UI for apps, it composed of widgets and quite natural to use compared to javafx.</p>
<p>The first feature i created was called &ldquo;Learning to read without spelling&rdquo;, i dont know if my translation from Indonesian is correct, but basically it is a new method to teach kid learning to read faster without them have to know about each alphabets first. So this feature required voice to help children know how to read the words when they click or tap the word. Initially I use potrait as my app&rsquo;s screen orientation, but as time goes and also with more addition of menus to my app, I began to changed the new screen orientations of new menu to landscape. Everything goes well until few weeks ago where the crash and ANR rate for my app began to hike, and the culprit was audioplayer.</p>
<p><img src="/audioplayer_bugs.PNG" alt="Audioplayer Bugs"></p>
<p>As the picture above, from today alone as a write this post, the crashs caused by audioplayers totaled 79 users affected. So yesterday i began to bugs hunting, because you also have to know, if you have apps on playstore and your crash and ANR goes beyond the normal limits, your app visibility will goes down, so did my app, it goes from became one of the top result for certain keyword searches to become gone nowhere.</p>
<h1 id="the-solutions">The solutions</h1>
<p>So after i looked serveral times to my source code, i accidentally found that when audio was playing in one menu, then i closed that menu and switched to another game, if the new game&rsquo;s screen orientation is not the same as the previuos one, it will crash. Also it happened the the ReleaseMode.loop is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>\First menu in landscape oriantation
</span></span><span style="display:flex;"><span>    \Playing looping background sound
</span></span><span style="display:flex;"><span>    \Stop all the playing audios
</span></span><span style="display:flex;"><span>    \Clear all caches
</span></span><span style="display:flex;"><span>\Second menu in potrait orientation
</span></span><span style="display:flex;"><span>    \Sound from the previous menu began to play.
</span></span><span style="display:flex;"><span>    \Stop this menu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Crashed
</span></span></code></pre></div><p>So few key events that happened were:</p>
<ol>
<li>AudioPlayers playing sound in looping using ReleaseMode.loop</li>
<li>Switch to another menu with difference orientations.</li>
</ol>
<p>So after noticed this behaviour, i refactored all my games and menus in my app into landscape orientations. After tested serveral times, no more crash happened in my app.</p>

		</section>

		<div class="post-tags">
			
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/zarkasy" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024  @AplikasiHebat |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


  


<script>
  feather.replace()
</script></div>
    </body>
</html>
